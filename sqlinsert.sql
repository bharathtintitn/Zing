DROP index cola_market_spatial_idx;
DROP TABLE cola_market PURGE;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'cola_market';

CREATE TABLE cola_market(
    id NUMBER PRIMARY KEY,
    name VARCHAR(32),
    shape MDSYS.SDO_GEOMETRY);
    
--circle (Head)
INSERT INTO cola_market VALUES(
    1, 'circle', MDSYS.SDO_GEOMETRY (2003, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 4),
        MDSYS.SDO_ORDINATE_ARRAY(175,270, 175,390, 130,325))
);
    
--line (hand)
INSERT INTO cola_market VALUES(
    2, 'line', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1),
        MDSYS.SDO_ORDINATE_ARRAY(200,250, 300,250 ))
);
--polygon (nice guy)
INSERT INTO cola_market VALUES (
  3,'name', MDSYS.SDO_GEOMETRY (2003,NULL,NULL,
   MDSYS.SDO_ELEM_INFO_ARRAY(1,1003,1), -- one polygon (ext ring)
   MDSYS.SDO_ORDINATE_ARRAY(158,264, 226,264, 208,150, 176,150, 158,264))
);


 --1st leg (nice Guy)
INSERT INTO cola_market VALUES(
    4, '1stlet', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1, 5,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(175,150, 192,100, 175,100, 158,50 ))
);
INSERT INTO cola_market VALUES(
    400, '1stlet', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1, 5,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(192,100, 175,50, 175,100, 158,50 ))
);

 --2nd leg(nice Guy)
INSERT INTO cola_market VALUES(
    5, '2ndleg', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1, 5,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(209,150, 226,100, 210,100, 193,50 ))
);
INSERT INTO cola_market VALUES(
    401, '2ndleg', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1, 5,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(226,100, 209,50, 210,100, 193,50 ))
);

INSERT INTO cola_market VALUES(
    6, '2ndHand', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1,  5,2,1, 9,2,1, 13,2,1, 17,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(190,220, 235,195, 225,195, 265,225 , 265,225, 420,225, 420,225, 415,227, 420,225, 415,223))
);
INSERT INTO cola_market VALUES(
    402, '2ndHand', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1,  5,2,1, 9,2,1, 13,2,1, 17,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(235,195, 280,220, 225,195, 265,225 , 265,225, 420,225, 420,225, 415,227, 420,225, 415,223))
);

INSERT INTO cola_market VALUES(
    403, '2ndHand', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1,  5,2,1, 9,2,1, 13,2,1, 17,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(280,220, 425,220, 225,195, 265,225 , 265,225, 420,225, 420,225, 415,227, 420,225, 415,223))
);

INSERT INTO cola_market VALUES(
    404, '2ndHand', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1,  5,2,1, 9,2,1, 13,2,1, 17,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(425,220, 420,222, 225,195, 265,225 , 265,225, 420,225, 420,225, 415,227, 420,225, 415,223))
);

INSERT INTO cola_market VALUES(
    405, '2ndHand', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1,  5,2,1, 9,2,1, 13,2,1, 17,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(425,220, 420,218, 225,195, 265,225 , 265,225, 420,225, 420,225, 415,227, 420,225, 415,223))
);


--arc and straight line 
INSERT INTO cola_market VALUES(
    7, 'D', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(300,162, 300,280))
);    

INSERT INTO cola_market VALUES(
    406, 'D', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(290,168, 390,225, 300,287))
); 
--monster 1st hand line
INSERT INTO cola_market VALUES(
    8, 'hand1', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(470,200, 510,230, 587,250))
		MDSYS.SDO_ORDINATE_ARRAY(470,250, 510,230, 587,200))
);


--monster 2nd hand
INSERT INTO cola_market VALUES(
    9, 'hand2', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(500,170, 540,200, 589,225))
		MDSYS.SDO_ORDINATE_ARRAY(500,280, 540,260, 589,225))
);


--monster body front
INSERT INTO cola_market VALUES(
    33, 'body', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(580,290,589,225,590,160))
		MDSYS.SDO_ORDINATE_ARRAY(570,290,589,225,580,160))
);


--monster body back
INSERT INTO cola_market VALUES(
    32, 'body', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
		--MDSYS.SDO_ORDINATE_ARRAY(660,150, 650,225, 640,310))
        MDSYS.SDO_ORDINATE_ARRAY(625,150, 645,225, 650,310))
);

--monster head
INSERT INTO cola_market VALUES(
    35, 'head', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(580,290,640,310,670,340))
		MDSYS.SDO_ORDINATE_ARRAY(570,160,635,170,660,125))
);



INSERT INTO cola_market VALUES(
    36, 'head', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(570,355,630,380,640,380))
		MDSYS.SDO_ORDINATE_ARRAY(550,125,605,90,630,95))
);

INSERT INTO cola_market VALUES(
    37, 'head', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(550,125,535,153,580,160))
);


INSERT INTO cola_market VALUES(
    38, 'head', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(650,125,665,105,630,95))
);

--monster leg front
INSERT INTO cola_market VALUES(
    26, 'leg', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(540,50, 535,80, 610,180))
		MDSYS.SDO_ORDINATE_ARRAY(570,290, 530,320, 510,380))
);

INSERT INTO cola_market VALUES(
    27, 'leg', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(540,50, 535,80, 610,180))
		MDSYS.SDO_ORDINATE_ARRAY(500,380, 523,370, 545,380))
);


INSERT INTO cola_market VALUES(
    28, 'leg', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(540,50, 535,80, 610,180))
		MDSYS.SDO_ORDINATE_ARRAY(535,380, 565,350, 600,330))
);

INSERT INTO cola_market VALUES(
    29, 'leg', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(540,50, 535,80, 610,180))
		MDSYS.SDO_ORDINATE_ARRAY(590,330, 640,350, 642,370))
);


INSERT INTO cola_market VALUES(
    30, 'leg', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(540,50, 535,80, 610,180))
		MDSYS.SDO_ORDINATE_ARRAY(632,370, 662,370, 682,370))
);


INSERT INTO cola_market VALUES(
    31, 'leg', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(540,50, 535,80, 610,180))
		MDSYS.SDO_ORDINATE_ARRAY(672,370, 672,357, 682,345))
);


INSERT INTO cola_market VALUES(
    320, '1leg', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        --MDSYS.SDO_ORDINATE_ARRAY(540,50, 535,80, 610,180))
		MDSYS.SDO_ORDINATE_ARRAY(672,345, 630,325, 650,310))
);

--monster finger
INSERT INTO cola_market VALUES(
    22, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(470,250, 480,250,495,250))
);

INSERT INTO cola_market VALUES(
    23, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(485,250, 485,248,482,260))
);


INSERT INTO cola_market VALUES(
    24, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(472,260, 485,260,500,260))
);


INSERT INTO cola_market VALUES(
    25, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(490,260, 485,263,482,272))
);


INSERT INTO cola_market VALUES(
    408, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(472,272, 485,272,500,272))
);


INSERT INTO cola_market VALUES(
    409, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(490,272, 488,275,485,280))
);


INSERT INTO cola_market VALUES(
    410, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(475,280, 488,280,485,280))
);
INSERT INTO cola_market VALUES(
    411, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(475,280, 500,280,510,280))
);

INSERT INTO cola_market VALUES(
    412, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(475,280, 500,280,510,280))
);

--monster mouth

INSERT INTO cola_market VALUES(
    413, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(570,160, 585,150,600,150))
);

INSERT INTO cola_market VALUES(
    414, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(568,128, 580,120,588,128))
);


INSERT INTO cola_market VALUES(
    415, 'finger', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(568,128, 580,136,588,128))
);

--monster horn


INSERT INTO cola_market VALUES(
    416, 'horn', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(568,110, 572,95,578,80))
);


INSERT INTO cola_market VALUES(
    417, 'horn', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(568,80,585,95, 584,108))
);


INSERT INTO cola_market VALUES(
    418, 'horn', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(590,78,605,95, 610,98))
);


INSERT INTO cola_market VALUES(
    419, 'horn', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(590,78,610,95, 620,98))
);

--nice guy eye

INSERT INTO cola_market VALUES(
    420, 'eye', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(190,150, 200,140,210,150))
);


INSERT INTO cola_market VALUES(
    421, 'eye', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(190,150, 200,160,210,150))
);

-- zinc now

INSERT INTO cola_market VALUES(
    422, 'line', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1),
        MDSYS.SDO_ORDINATE_ARRAY(50,400, 120,400 ))
);


INSERT INTO cola_market VALUES(
    423, 'line', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1),
        MDSYS.SDO_ORDINATE_ARRAY(120,400, 50,350 ))
);

INSERT INTO cola_market VALUES(
    424, 'line', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1),
        MDSYS.SDO_ORDINATE_ARRAY(50,350, 120,350 ))
);

-- now i
INSERT INTO cola_market VALUES(
    425, 'line', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1),
        MDSYS.SDO_ORDINATE_ARRAY(150,350, 150,400 ))
);

-- now n

INSERT INTO cola_market VALUES(
    426, 'line', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1),
        MDSYS.SDO_ORDINATE_ARRAY(200,350, 200,400 ))
);


INSERT INTO cola_market VALUES(
    427, 'line', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1),
        MDSYS.SDO_ORDINATE_ARRAY(200,400, 250,350 ))
);


INSERT INTO cola_market VALUES(
    428, 'line', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1),
        MDSYS.SDO_ORDINATE_ARRAY(250,350, 250,400 ))
);

-- Draw G
INSERT INTO cola_market VALUES(
    429, 'drawG', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2, 7,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(300,50, 250,80,300,100, 300,360, 275,360))
);
INSERT INTO cola_market VALUES(
    430, 'drawG', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2, 7,2,1),
        MDSYS.SDO_ORDINATE_ARRAY(290,100, 310,80,290,80, 300,360, 275,360))
);

-- draw i


INSERT INTO cola_market VALUES(
    431, 'line', MDSYS.SDO_GEOMETRY (2002, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1),
        MDSYS.SDO_ORDINATE_ARRAY(320,350, 320,400 ))
);

INSERT INTO cola_market VALUES(
    432, 'drawG', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(310,110, 315,105,320,110))
);


INSERT INTO cola_market VALUES(
    433, 'drawG', MDSYS.SDO_GEOMETRY (2006, NULL, NULL,
        MDSYS.SDO_ELEM_INFO_ARRAY(1,2,2),
        MDSYS.SDO_ORDINATE_ARRAY(310,110, 325,105,320,110))
);
commit;


SELECT SDO_GEOM.SDO_INTERSECTION(c_a.shape, c_c.shape, 0.005)
  FROM cola_market c_a, cola_market c_c
  WHERE c_a.name = 'drawG' AND c_c.name = 'drawG';